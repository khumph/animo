---
title: "ANIMO efficacy outcome Tables"
author: "Kyle Humphrey"
date: "`r format(Sys.time(), '%B %d %Y')`"
output: html_document
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, encoding = encoding, output_dir = "../results") })
editor_options: 
  chunk_output_type: console
---

```{r setup, echo = F, warning = F, message = F}
rm(list = ls())
knitr::opts_chunk$set(warning = F, echo = F, message = F)
library(pacman)
p_load(Hmisc, readxl, lme4, multcomp, tidyverse, broom, Gmisc)
select <- dplyr::select
```

```{r, eval = F} 
# change eval to T if you want to clean raw data
source('clean-data.R')
```

```{r load cleaned data}
load('../data/animo-cleaned.Rdata')
```

```{r table functions}
source('table-functions.R')
```

```{r contrasts}
source('contrasts.R')
```

```{r blood measures variables and labels}
blood_labels <- tibble(
  hba1c = "HbA1c",
  alt = "ALT",
  ast = "AST",
  cholesterol = "Cholesterol",
  hdl = "HDL Cholesterol",
  ldl = "LDL Cholesterol",
  triglycerides = "Triglycerides",
  hscrp = "hs-CRP"
)

# log transform variables -------------------------------------------------

blood_labels <- blood_labels %>%
  rename_all(funs(paste0("log(", ., ")")))
```

```{r blood models}
blood_results <- run_all(blood_labels, animo)
```

```{r cardiometabolic table}
make_table(blood_results, blood_labels, caption = "Table XX: Cardiometabolic measures.")
```

```{r macro measures variables and labels}
macro_labels <- tibble(
  weight = "Weight (kg)",
  `log(weight)` = "Percent weight change",
  waist = "Waist circumference (cm)",
  pct_fat = "Percent body fat",
  total_PA_minutes = "LTPA<sup>a</sup> (minutes/week)",
  kcals_per_day = "Average caloric intake (kcal/day)"
)
```

```{r macro models}
macro_results <- run_all(macro_labels, animo)
```

```{r macro mean table}
make_table(macro_results, macro_labels, caption = "Table XX: measures.",
           tfoot = "\n<sup>c</sup>Lesiure time physical activity.")
```
